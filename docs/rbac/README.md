# RBAC (Role-Based Access Control) ドキュメント

## 概要

このディレクトリには、学習用RBAC実装の設計ドキュメントが含まれています。RBACは、ロール（役割）という抽象層を導入することで、ユーザーと権限の間接的な管理を実現する権限管理パターンです。

## ドキュメント構成

### 📋 設計ドキュメント

- **[design-doc.md](./design-doc.md)** - RBAC実装の詳細な技術設計書
  - アーキテクチャ設計（2層構造）
  - 型定義とAPI設計
  - 権限評価アルゴリズム
  - 学習パスとテスト戦略

### 🎯 アーキテクチャ決定記録（ADR）

各ADRは特定の設計決定に焦点を当てています：

- **[adr/](./adr/)** - アーキテクチャ決定記録のディレクトリ
  - [001-role-model.md](./adr/001-role-model.md) - ロールモデル：グローバル管理と2層アーキテクチャ
  - [002-role-hierarchy.md](./adr/002-role-hierarchy.md) - ロール階層：階層なしのフラット設計
  - [003-multiple-roles.md](./adr/003-multiple-roles.md) - 複数ロール：ユーザーの複数ロール割り当て
  - [004-permission-evaluation.md](./adr/004-permission-evaluation.md) - 権限評価：OR演算による統合
  - [005-deny-policy.md](./adr/005-deny-policy.md) - Deny機能：実装しない決定と理由
  - [006-api-design.md](./adr/006-api-design.md) - API設計：最小限のメソッドセット

### 📊 参考資料

- **[library-comparison.md](./library-comparison.md)** - 主要RBACライブラリの比較分析
  - Spring Security、Casbin、Keycloak等の特徴
  - 階層サポート、Deny機能、API設計の比較
  - 学習曲線と複雑性の評価

- **[examples.md](./examples.md)** - 実装例とコードサンプル
  - 基本的な使用例
  - 複数ロールの統合
  - 組織変更シナリオ
  - ACLとの比較

## 学習の流れ

### 1. 基礎理解
1. [design-doc.md](./design-doc.md) でRBACの全体像を把握
2. ACLからの発展と違いを理解

### 2. 設計決定の理解
各ADRを順番に読み、なぜその決定がなされたかを理解：
- なぜ階層を実装しないか
- なぜDenyが不要か
- なぜ複数ロールを許可するか

### 3. 実装の学習
1. [examples.md](./examples.md) で具体的なコード例を確認
2. ACLとの管理コスト比較を体験

### 4. 発展的学習
- [library-comparison.md](./library-comparison.md) で実務的なライブラリを知る
- 将来の拡張（階層、ABAC移行）を検討

## RBACの核心概念

```
┌──────────┐     割り当て    ┌──────────┐    持つ     ┌──────────┐
│  User    │ ───────────→ │   Role   │ ────────→ │Permission│
└──────────┘              └──────────┘           └──────────┘
   Alice                     Editor               Read, Write
```

- **間接的な権限管理**: ユーザーは直接権限を持たず、ロール経由で権限を取得
- **管理の簡素化**: O(ユーザー数×リソース数) → O(ユーザー数+ロール数)
- **組織構造の反映**: 実際の職務や責任をロールとして表現

## 主要な設計決定

| 項目 | 決定 | 理由 |
|------|------|------|
| **ロール階層** | なし（フラット） | RBACの本質に集中、学習効果を最大化 |
| **Deny機能** | なし | ポジティブ権限モデルを採用、管理の簡素化 |
| **複数ロール** | 許可 | 実際の組織構造を反映、柔軟性を確保 |
| **権限統合** | OR演算 | 最も寛容な権限を採用、直感的な動作 |
| **API名** | `authorize` | 業界標準の用語を使用 |

## 実装コードとの関係

実装コードは `src/rbac/` ディレクトリにあります：
- 型定義とインターフェース
- RoleManagerクラス
- RbacProtectedResourceクラス
- テストコード

## 関連ドキュメント

- [Unix権限](../unix/) - 基本的な権限概念
- [ACL](../acl/) - 直接的な権限設定との比較
- [ABAC](../abac/) - より柔軟な属性ベースへの発展
- [ReBAC](../rebac/) - 関係性ベースの権限管理

## 次のステップ

1. **実装を試す**: `src/rbac/` のコードを実行してRBACを体験
2. **テストを書く**: 様々なシナリオでRBACの動作を確認
3. **ACLと比較**: 同じシナリオで管理コストの違いを体験
4. **拡張を検討**: 階層サポートやABACへの移行を考察