# TODO: ReBAC ドキュメント再構成タスク

## 目的
現在の `docs/adr-rebac-design.md` （2000行以上の長大なファイル）を、Design DocとADRに分離して整理する。

## 採用する構造（案C: カテゴリ別のADR分類）

```
docs/
├── rebac/
│   ├── README.md                        # 全体概要とナビゲーション
│   ├── design-doc.md                    # 詳細な技術設計書
│   ├── adr/
│   │   ├── README.md                    # ADR一覧と決定の要約
│   │   ├── 001-core-model.md            # コアモデル：タプルとグラフ構造
│   │   ├── 002-traversal-algorithm.md   # 探索：BFSと深度制限
│   │   ├── 003-type-system.md           # 型設計：関係タイプの分離
│   │   ├── 004-architecture.md          # アーキテクチャ：クラス責任分離
│   │   ├── 005-permission-evaluation.md # 権限評価：ルールベース設計
│   │   └── 006-feature-scope.md         # 機能範囲：Denyなし、基本機能のみ
│   ├── learning-notes.md                # 学習過程のメモ（既存を移動）
│   └── examples.md                      # 実装例とコードサンプル
└── [他の既存ファイル]
```

## 作業タスク

### Phase 1: ディレクトリ構造の作成
- [x] `docs/rebac/` ディレクトリ作成
- [x] `docs/rebac/adr/` ディレクトリ作成
- [x] `docs/rebac/todo-fix-docs.md` 作成（このファイル）

### Phase 2: 元ファイルの内容整理
現在の `docs/adr-rebac-design.md` から以下の内容を抽出・整理：

#### ADRファイルへの分割（各ファイルは簡潔に）
- [x] **001-core-model.md**
  - 3.1節: 関係性の表現方法（タプル vs オブジェクト形式）
  - 3.2節: グラフ構造の実装（隣接リスト vs 隣接行列）
  - 4.1.1節: 関係性タプルによるモデル化の決定

- [x] **002-traversal-algorithm.md**
  - 3.3節: 探索アルゴリズム（BFS vs DFS）
  - 3.4節: 推移的関係の深さ制限
  - 3.7節: 循環参照の検出
  - 3.8節: 探索アルゴリズムの業界標準

- [x] **003-type-system.md**
  - 3.1.2節: 関係性の型定義
  - 3.1.3節: 関係タイプの型安全性（EntityRelationType vs ResourceRelationType）
  - 4.1.1節の型分離設計部分

- [x] **004-architecture.md**
  - 3.9節: クラス構造の設計（探索ロジックの分離）
  - 単一責任の原則とテスタビリティ

- [x] **005-permission-evaluation.md**
  - 3.5節: 権限の導出ルール
  - 4.1.4節: 権限評価のインターフェース
  - 4.1.6節: 権限判定結果における関係性の表現

- [x] **006-feature-scope.md**
  - 3.6節: Deny機能の扱い（実装しない決定）
  - 将来の拡張性の考慮

#### Design Docへの集約
- [x] **design-doc.md**
  - 2節: コンテキスト全体（ReBACの概念説明、業界調査）
  - 4.5節: 実装の詳細解説
  - 5節: 理由と根拠
  - 6節: 結果と影響

#### 実装例の整理
- [x] **examples.md**
  - 7節: 実装例全体
  - 基本的な使用例
  - 型安全な実装例
  - 他モデルとの比較例

### Phase 3: メタファイルの作成
- [x] **docs/rebac/README.md**
  - ReBACドキュメントの概要
  - 各ファイルへのナビゲーション
  - 学習パスの提示

- [x] **docs/rebac/adr/README.md**
  - ADR一覧
  - 各決定事項の要約
  - 決定間の関連性

### Phase 4: 既存ファイルの処理
- [x] `docs/rebac-learning-notes.md` を `docs/rebac/learning-notes.md` へ移動
- [ ] `docs/adr-rebac-design.md` をアーカイブまたは削除（確認後）

## ADRテンプレート

各ADRファイルは以下の形式で記述：

```markdown
# ADR-XXX: [タイトル]

## ステータス
- **日付**: 2025-08-XX
- **状態**: 承認
- **決定者**: プロジェクトチーム

## コンテキスト
[なぜこの決定が必要か、簡潔な背景]

## 検討したオプション

### オプション1: [名前]
- 利点: ...
- 欠点: ...

### オプション2: [名前]
- 利点: ...
- 欠点: ...

## 決定
[選択したオプション]を採用する。

[簡潔な理由]

## 結果
- **利点**: ...
- **トレードオフ**: ...
- **今後の課題**: ...
```

## 注意事項

1. **ADRは簡潔に**: 各ADRは1つの決定事項に集中し、2-3ページ以内に収める
2. **Design Docは詳細に**: 技術的な詳細、実装の説明、概念の解説はDesign Docに集約
3. **実装例は独立**: コードサンプルはexamples.mdに整理し、ADRからは参照のみ
4. **相互参照**: 各ドキュメント間で適切に相互参照を設定

## 完了基準

- [ ] すべてのファイルが作成され、内容が適切に分割されている
- [ ] 各ADRが独立して理解可能
- [ ] Design Docが包括的な技術説明を提供
- [ ] README.mdによるナビゲーションが機能している
- [ ] 元の長大なファイルが適切に処理されている

## 備考

このタスクは、ReBACの学習と実装を進める中で蓄積された知識を、より管理しやすく、参照しやすい形に再構成するものである。特に、複数の設計決定が混在していた元のファイルを、各決定事項ごとに独立したADRとして分離することで、将来の設計変更や追加決定の際の影響範囲を明確にする。